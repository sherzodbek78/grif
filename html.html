<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Head Ball Mobile Frontend</title>
    <style>
        body { margin: 0; overflow: hidden; background: #87CEEB; font-family: 'Impact', sans-serif; touch-action: none; }
        canvas { display: block; background: #87CEEB; margin: 0 auto; border-bottom: 20px solid #2b228b; }
        .controls { position: absolute; bottom: 20px; width: 100%; display: flex; justify-content: space-between; padding: 0 30px; box-sizing: border-box; pointer-events: none; }
        .btn { width: 80px; height: 80px; background: rgba(255,255,255,0.3); border-radius: 20px; display: flex; align-items: center; justify-content: center; font-size: 40px; color: white; pointer-events: auto; user-select: none; }
        .score { position: absolute; top: 20px; width: 100%; text-align: center; font-size: 48px; color: white; text-shadow: 2px 2px black; }
    </style>
</head>
<body>

    <div class="score" id="scoreBoard">0 : 0</div>

    <canvas id="gameCanvas"></canvas>

    <div class="controls">
        <div style="display: flex; gap: 20px;">
            <div class="btn" id="btnLeft">←</div>
            <div class="btn" id="btnRight">→</div>
        </div>
        <div class="btn" id="btnJump">↑</div>
    </div>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const scoreBoard = document.getElementById('scoreBoard');

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    const gravity = 0.8;
    const groundHeight = 20;

    let p1 = { x: 100, y: 0, w: 60, h: 60, color: 'red', dy: 0, dx: 0, score: 0, jumping: false };
    let bot = { x: canvas.width - 160, y: 0, w: 60, h: 60, color: 'blue', dy: 0, dx: 0, score: 0, jumping: false };
    let ball = { x: canvas.width / 2, y: canvas.height / 2, r: 15, dx: 0, dy: 0 };

    // Boshqaruv holati
    let keys = { left: false, right: false, jump: false };

    // Sensorli boshqaruv
    document.getElementById('btnLeft').ontouchstart = () => keys.left = true;
    document.getElementById('btnLeft').ontouchend = () => keys.left = false;
    document.getElementById('btnRight').ontouchstart = () => keys.right = true;
    document.getElementById('btnRight').ontouchend = () => keys.right = false;
    document.getElementById('btnJump').ontouchstart = () => keys.jump = true;
    document.getElementById('btnJump').ontouchend = () => keys.jump = false;

    // Klaviatura boshqaruv
    window.onkeydown = (e) => {
        if(e.key === 'a' || e.key === 'ArrowLeft') keys.left = true;
        if(e.key === 'd' || e.key === 'ArrowRight') keys.right = true;
        if(e.key === 'w' || e.key === 'ArrowUp') keys.jump = true;
    };
    window.onkeyup = (e) => {
        if(e.key === 'a' || e.key === 'ArrowLeft') keys.left = false;
        if(e.key === 'd' || e.key === 'ArrowRight') keys.right = false;
        if(e.key === 'w' || e.key === 'ArrowUp') keys.jump = false;
    };

    function resetBall() {
        ball.x = canvas.width / 2;
        ball.y = canvas.height / 2;
        ball.dx = 0; ball.dy = 0;
    }

    function update() {
        // P1 harakati
        if (keys.left) p1.dx = -8;
        else if (keys.right) p1.dx = 8;
        else p1.dx = 0;

        if (keys.jump && !p1.jumping) {
            p1.dy = -18;
            p1.jumping = true;
        }

        // Bot AI (Soddalashtirilgan)
        if (ball.x > bot.x + 20) bot.dx = 6;
        else if (ball.x < bot.x - 20) bot.dx = -6;
        if (ball.y < bot.y - 100 && !bot.jumping) { bot.dy = -18; bot.jumping = true; }

        // Fizika qo'llash
        [p1, bot].forEach(p => {
            p.dy += gravity;
            p.y += p.dy;
            p.x += p.dx;
            if (p.y > canvas.height - groundHeight - p.h) {
                p.y = canvas.height - groundHeight - p.h;
                p.dy = 0;
                p.jumping = false;
            }
            if (p.x < 0) p.x = 0;
            if (p.x > canvas.width - p.w) p.x = canvas.width - p.w;
        });

        // To'p fizikasi
        ball.dy += 0.4;
        ball.x += ball.dx;
        ball.y += ball.dy;

        if (ball.y > canvas.height - groundHeight - ball.r) {
            ball.y = canvas.height - groundHeight - ball.r;
            ball.dy *= -0.7;
        }
        if (ball.x < 0 || ball.x > canvas.width) ball.dx *= -1;

        // To'qnashuv (Player vs Ball)
        [p1, bot].forEach(p => {
            if (ball.x + ball.r > p.x && ball.x - ball.r < p.x + p.w &&
                ball.y + ball.r > p.y && ball.y - ball.r < p.y + p.h) {
                ball.dy = -12;
                ball.dx = (ball.x - (p.x + p.w / 2)) * 0.5;
            }
        });

        // Gollar
        if (ball.x < 10 && ball.y > canvas.height - 150) { bot.score++; resetBall(); }
        if (ball.x > canvas.width - 10 && ball.y > canvas.height - 150) { p1.score++; resetBall(); }

        scoreBoard.innerText = `${p1.score} : ${bot.score}`;
    }

    function drawFans() {
        ctx.fillStyle = "#555";
        ctx.fillRect(0, 200, canvas.width, canvas.height - 200);
        for (let y = 220; y < canvas.height - 150; y += 40) {
            for (let x = 20; x < canvas.width; x += 40) {
                ctx.fillStyle = `hsl(${(x+y)%360}, 50%, 50%)`;
                ctx.beginPath();
                ctx.arc(x, y, 8, 0, Math.PI * 2);
                ctx.fill();
            }
        }
    }

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        drawFans();

        // Darvozalar
        ctx.fillStyle = "white";
        ctx.fillRect(0, canvas.height - 150, 10, 130);
        ctx.fillRect(canvas.width - 10, canvas.height - 150, 10, 130);

        // O'yinchilar
        ctx.fillStyle = p1.color;
        ctx.beginPath(); ctx.ellipse(p1.x + 30, p1.y + 30, 30, 30, 0, 0, Math.PI * 2); ctx.fill();
        ctx.fillStyle = bot.color;
        ctx.beginPath(); ctx.ellipse(bot.x + 30, bot.y + 30, 30, 30, 0, 0, Math.PI * 2); ctx.fill();

        // To'p
        ctx.fillStyle = "white";
        ctx.beginPath(); ctx.arc(ball.x, ball.y, ball.r, 0, Math.PI * 2); ctx.fill();
        ctx.stroke();

        update();
        requestAnimationFrame(draw);
    }

    draw();
</script>
</body>
</html>